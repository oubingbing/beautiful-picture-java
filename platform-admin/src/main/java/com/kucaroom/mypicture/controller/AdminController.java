package com.kucaroom.mypicture.controller;import com.kucaroom.mypicture.DTO.PictureDTO;import com.kucaroom.mypicture.converter.PictureFormToPictureDTO;import com.kucaroom.mypicture.form.PictureForm;import com.kucaroom.mypicture.service.QiNiuService;import com.kucaroom.mypicture.util.ResponseData;import com.kucaroom.mypicture.util.ResponseUtil;import lombok.extern.slf4j.Slf4j;import org.apache.shiro.SecurityUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.boot.context.properties.bind.BindResult;import org.springframework.stereotype.Controller;import org.springframework.validation.BindingResult;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.web.servlet.ModelAndView;import javax.validation.Valid;import java.util.HashMap;import java.util.Map;@Slf4j@Controller@RequestMapping("/admin")public class AdminController {    @Autowired    private QiNiuService qiNiuService;    @GetMapping("")    public ModelAndView index(){        log.info("登录用户：{}",SecurityUtils.getSubject().getPrincipal());        return new ModelAndView("/admin/index");    }    @GetMapping("/dashboard")    public ModelAndView dashboard(){        return new ModelAndView("/admin/dashboard");    }    @GetMapping("/upload")    public ModelAndView uploadPicture(){        return new ModelAndView("/admin/upload");    }    @ResponseBody    @PostMapping("/upload")    public ResponseData upload(@Valid PictureForm pictureForm, BindingResult bindingResult){        PictureDTO pictureDTO = PictureFormToPictureDTO.convert(pictureForm);        log.info("DTO：{}",pictureDTO.toString());        return ResponseUtil.success("ok");    }    @ResponseBody    @GetMapping("/token")    public ResponseData uploadToken(){        String token = qiNiuService.getToken(74);        Map<String,String> map = new HashMap<>();        map.put("token",token);        map.put("domain","http://picture.qiuhuiyi.cn");        return ResponseUtil.success(map);    }}